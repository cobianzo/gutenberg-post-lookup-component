(()=>{"use strict";var e,n={234:(e,n,t)=>{const o=window.wp.blocks,s=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"coco/test-block","version":"1.0.0","title":"Coco Test Block","category":"widgets","icon":"smiley","description":"A test block for the Coco Post Lookup plugin","supports":{"html":false},"attributes":{"postID":{"type":"number","default":0}},"textdomain":"coco","editorScript":"file:../../build/test-block.js","editorStyle":"file:../../build/style-test-block.css","style":"file:../../build/style-test-block.css","render":"file:./render.php"}'),r=window.wp.blockEditor,l=window.wp.components,c=window.wp.i18n,i=window.wp.element,d=window.React,a=window.wp.apiFetch;var p=t.n(a);const u=window.wp.data;function h(e){const[n,t]=(0,i.useState)(!1);return{post:(0,u.useSelect)((n=>{if(!e)return null;const{getEntityRecord:o}=n("core");return t(!1),o("postType","post",e)}),[e]),isLoading:n}}const b=window.ReactJSXRuntime;function x(e){return(0,b.jsx)("button",{onClick:e.onClick,type:"button",className:"x-button components-button block-editor-inspector-popover-header__action has-icon","aria-label":"Close",children:(0,b.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24","aria-hidden":"true",focusable:"false",children:(0,b.jsx)("path",{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"})})})}const m=e=>{const{selectedPostId:n,updateSelectedPostId:t}=e,[o,s]=(0,i.useState)(null),r=function(e,n){const[t,o]=(0,d.useState)(e);return(0,d.useEffect)((()=>{const t=setTimeout((()=>{o(e)}),n);return()=>{clearTimeout(t)}}),[e,n]),t}(o,300),{posts:a,loading:u,error:m}=function(e){const[n,t]=(0,i.useState)([]),[o,s]=(0,i.useState)(!1),[r,l]=(0,i.useState)(null);return(0,i.useEffect)((()=>{e?(s(!0),l(null),p()({path:`/wp/v2/posts?search=${encodeURIComponent(e)}&per_page=10`}).then((e=>{t(e),s(!1)})).catch((e=>{l("Failed to fetch posts"+e.message),s(!1)}))):t([])}),[e]),{posts:n,loading:o,error:r}}(r),{post:f}=h(n),v=(0,i.useRef)(null);(0,i.useEffect)((()=>{const e=document.createElement("style");return e.textContent="\n  .coco__post-lookup {\n    position: relative;\n\n    input.components-text-control__input {\n      padding-right: 40px;\n    }\n\n    .x-button {\n      position: absolute;\n      top: 60px;\n      right: 10px;\n    }\n\n    .post-lookup__inner-row {\n      position: relative;\n    }\n    .post-lookup__inner-row .x-button {\n      top: 10px;\n    }\n\n    ul {\n      background: #fffffff4;\n      padding: 0 0.5rem;\n      border: 1px solid #ccc;\n      box-shadow: 1px 7px 9px -9px #000000;\n      position: absolute;\n      width: 100%;\n      top: 74px;\n    }\n\n    li {\n      padding: 0;\n      border-bottom: 1px solid #cccccc;\n      margin: 0;\n    }\n\n    li button {\n      width: 100%;\n    }\n\n    button.button--unstyled {\n      display: flex;\n      gap: 1rem;\n      padding: 0.5rem;\n      align-items: center;\n      cursor: pointer;\n      background: transparent;\n      border: 0;\n      color: var( --wp-components-color-accent, var( --wp-admin-theme-color, #3858e9 ) );\n    }\n\n    button.button--unstyled:hover {\n      background-color: rgba( var( --wp-admin-theme-color--rgb ), 0.04 );\n    }\n  }\n",document.head.appendChild(e),()=>{document.head.removeChild(e)}}));const w=(0,i.useCallback)((e=>{s(e)}),[]);return(0,b.jsxs)("div",{className:"coco__post-lookup",children:[(0,b.jsx)("div",{className:"post-lookup__preview",children:n?(0,b.jsx)("p",{children:" "}):(0,b.jsx)("p",{children:"No post selected"})}),n&&f?.id&&null===o?(0,b.jsxs)("div",{className:"post-lookup__preview",children:[(0,b.jsx)("p",{children:"SELECTED POST:"}),(0,b.jsxs)("div",{className:"post-lookup__inner-row",children:[(0,b.jsxs)("button",{className:"button--unstyled",onClick:()=>{s(""),setTimeout((()=>v.current?.focus()),500)},children:[(0,b.jsx)("span",{className:"dashicons dashicons-edit"}),f.title.rendered]}),n&&n>0?(0,b.jsx)(x,{onClick:()=>e.updateSelectedPostId(0)}):""]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.TextControl,{label:(0,c.__)("Search for a post","coco"),value:o||"",onChange:w,placeholder:(0,c.__)("Search…","coco"),ref:v}),n&&n>0?(0,b.jsx)(x,{onClick:()=>s(null)}):null,u&&(0,b.jsx)(l.Spinner,{}),m&&(0,b.jsx)("div",{className:"notice notice-error",children:(0,b.jsx)("p",{children:(0,c.__)("Error:","coco")+m})}),a.length>0&&(0,b.jsx)("ul",{children:a.map((e=>(0,b.jsx)("li",{children:(0,b.jsx)("button",{className:"button--unstyled",onClick:()=>{return n=e.id,t(n),void s(null);var n},children:e.title.rendered})},e.id)))}),n?(0,b.jsxs)("p",{children:[" ",(0,c.__)("Selected post ID:","coco")+n," "]}):null]})]})},f=s,{name:v,...w}=f;(0,o.registerBlockType)(s.name,{name:v,...w,edit:function(e){var n;const{post:t}=h(e.attributes.postID);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{...(0,r.useBlockProps)(),children:t?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("h2",{children:null!==(n=t?.title?.rendered)&&void 0!==n?n:"no post"}),(0,b.jsx)("div",{dangerouslySetInnerHTML:{__html:t?.content?.rendered.replace(/<[^>]+>/g,"")}})]}):(0,b.jsx)("p",{children:(0,c.__)("No post selected","coco")})}),(0,b.jsx)(r.InspectorControls,{children:(0,b.jsx)(l.Panel,{children:(0,b.jsx)(l.PanelBody,{children:(0,b.jsx)(m,{selectedPostId:e.attributes.postID,updateSelectedPostId:n=>e.setAttributes({postID:n||0})})})})})]})},save:function(){return(0,b.jsx)("div",{...r.useBlockProps.save()})}})}},t={};function o(e){var s=t[e];if(void 0!==s)return s.exports;var r=t[e]={exports:{}};return n[e](r,r.exports,o),r.exports}o.m=n,e=[],o.O=(n,t,s,r)=>{if(!t){var l=1/0;for(a=0;a<e.length;a++){t=e[a][0],s=e[a][1],r=e[a][2];for(var c=!0,i=0;i<t.length;i++)(!1&r||l>=r)&&Object.keys(o.O).every((e=>o.O[e](t[i])))?t.splice(i--,1):(c=!1,r<l&&(l=r));if(c){e.splice(a--,1);var d=s();void 0!==d&&(n=d)}}return n}r=r||0;for(var a=e.length;a>0&&e[a-1][2]>r;a--)e[a]=e[a-1];e[a]=[t,s,r]},o.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return o.d(n,{a:n}),n},o.d=(e,n)=>{for(var t in n)o.o(n,t)&&!o.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},o.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),(()=>{var e={755:0,202:0};o.O.j=n=>0===e[n];var n=(n,t)=>{var s,r,l=t[0],c=t[1],i=t[2],d=0;if(l.some((n=>0!==e[n]))){for(s in c)o.o(c,s)&&(o.m[s]=c[s]);if(i)var a=i(o)}for(n&&n(t);d<l.length;d++)r=l[d],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(a)},t=self.webpackChunk_cobianzo_gutenberg_post_lookup_component=self.webpackChunk_cobianzo_gutenberg_post_lookup_component||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))})();var s=o.O(void 0,[202],(()=>o(234)));s=o.O(s)})();